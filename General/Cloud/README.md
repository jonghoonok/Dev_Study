# Cloud

Azure를 중심으로 클라우드 기초 이론과 디자인 패턴 정리



## 0. 목차



* [1. Cloud Intro](#1-cloud-intro)
  * [1.2. Cloud Native](#12-Cloud-Native)
* [2. Cloud Providers](#2-cloud-providers)
  + [2.1. AWS](#21-aws)
  + [2.2. Azure](#22-azure)
* [3. Cloud Design Patterns](#3-cloud-design-patterns)
  + [3.1. Availability](#31-availability)
  + [3.2. Data Management](#32-data-management)
  + [3.3. Design and Implementation](#33-design-and-implementation)
  + [3.4. Management and Monitoring](#34-management-and-monitoring)



## 1. Cloud Intro



### 1.1. 클



IaaS



PaaS



SaaS



12팩터

- SaaS가 가져야 할 특성과 지켜야 할 패턴들에 대한 경험적인 내용
- 코드베이스
- 종속성
- 환경 설정
- 백엔드 서비스
- 빌드, 릴리스 및 실행
- 프로세스
- 포트 바인딩
- 동시성(concurrency)
- 폐기 가능(disposability)
- 개발, 테스트, 운영 환경의 일관성
- 로그
- 일회성 프로세스



### 1.2. Cloud Native



클라우드 네이티브란?

- **클라우드 환경에 친화적**인 애플리케이션, 아키텍쳐, 인프라 등의 환경



클라우드 네이티브 애플리케이션

- 클라우드 네이티브 환경에서 **SaaS나 FaaS 형태로 서비스되는 애플리케이션**
  - 비즈니스 환경 변화에 민첩하고 능동적으로 대응하기 위해 개발됨
  - 이를 충족할 수 있는 애플리케이션의 형태가 마이크로서비스
    - 클라우드 인프라 환경 + 컨테이너 환경 등으로 개발 및 배포가 간편해짐
- SaaS
  - 소프트웨어가 필요할 때 즉시 필요한 만큼만 사용할 수 있는 서비스 형태의 소프트웨어
  - **반복적이고 자주 사용되는 서비스들**은 SaaS처럼 공용화하여 서비스할 수 있는 환경이 됨
    - 개발 및 운영에 필요한 인프라 장비, 플랫폼은 클라우드로 옮기고 사용자 편의성을 증대
  - 가용성과 소스 버전의 관리를 중요한 특성으로 가지며 이를 고려한 개발이 필요
    - 불특정 다수의 사용자가 사용하는 온라인 서비스기 때문
- FaaS
  - 서비스의 수준을 기능 단위까지 세분하여 제공하는 기능 서비스
    - 필요할 때 즉시 사용할 수 있고, 기능들의 조합을 통해 새로운 서비스를 만들 수 있음
  - **필요한 기능을 직접 개발하지 않아도 됨** : 다른 사람이 이미 개발한 결과물을 사용할 수 있음
  - 예) AI, Big Data, ChatBot 등의 기능들



클라우드 네이티브 아키텍쳐

- 클라우드에 최적화된 애플리케이션을 개발하고 운영할 수 있는 아키텍쳐
  - 확장 가능하고, 탄력적이며 **장애 격리**가 가능해야 함
  - 서비스 생성-통합-배포, 비즈니스 환경 변화에 대응하는 시간 단축, 오류를 예측-대응할 수 있음
- **수평적 시스템 확장**에 초점을 맞춰 이를 실현함
  - 최소의 영향으로 복원할 수 있는 구조
  - 평소에 사용하지 않는 시스템 수준을 최적화하여 최소한의 시스템 사양으로 운영함
  - 예기치 못한 오류나 장애를 수용할 수 있는 구조로 설계
    - 논리적 격리 : 서비스를 완전히 독립적으로 나눔
    - 물리적 격리 : 서비스를 단독으로 중지, 기동, 수정 및 배포 가능한 인프라 환경의 제공 필요
- 고려해야 할 사항
  - 분할된 서비스 구조 : 상호 결합도를 최소화
  - Stateless 통신 프로토콜 : 서버의 장애가 클라이언트에 영향을 주지 않도록 함
  - Circuit Breaker 기능의 적용 : 오류가 발생했을 때 처리 경로를 대체할 응답을 보내서 장애를 회피



클라우드 네이티브 인프라

- 컨테이너 기반 패키지 : **컨테이너로 패키지된 단위를 실행 단위**로 가짐
  - 컨테이너 단위로 독립적인 인터페이스와 IP, 포트 번호를 가짐
  - 빠른 개발과 장애 대응 측면에서 효율적이고 효과적임
    - 문제가 있다면 컨테이너를 내리고 원래 이미지를 실행
    - 작게 분할된 서비스에 국한해서 제어가 가능
- 동적 관리
  - **서비스의 추가와 삭제를 시스템이 자동으로 감지**, 추가된 서비스로 요청을 라우팅할 수 있음
  - 컨테이너 단위로 패키지된 서비스의 동작을 감지하고 관리함



지속적 통합과 배포

[CI/CD]((../../General/CI CD/README.md))

- 지속적 통합(Continuous Integration)이란?
  - 개발 환경에서 **개발 중인 코드를 통합**하고 필요에 따라 **테스트를 병행**하는 일련의 프로세스
    - **파이프라인** : 통합 및 배포까지 일련의 프로세스를 연결
    - 서비스별로 하나씩 파이프라인을 구성하는 것이 바람직함
  - 클라우드 네이티브 환경 구축을 위해 중요
- CI절차
  1. 개발자가 소스 코드를 소스 저장소에 push
  2. 빌드 도구가 **일정한 주기로 반복적으로 소스들을 빌드**하여 바이너리 파일을 제작
     - 빌드 과정과 주기를 자동화해야 하고 빌드 시간이 짧아야 함
     - Jenkins 등의 빌드 도구가 사용됨
  3. 실행 환경으로 배포
- 지속적 배포
  - **continuous delivery** : 실행 환경 반영 전 단계까지 배포
    - 승인 및 배포 담당자의 허가를 받아 수동으로 실행 환경 반영
    - 대부분의 기업에서 채택하고 있는 방식
  - **continuous deployment** : 실행 환경까지 자동으로 배포
    - 소스 저장소에 빌드된 코드의 실행 파일을 실행 환경까지 자동으로 배포함
    - 자동화 정책이나 스케줄러 관리가 중요
- 릴리스
  - canary deployment
    - 새 버전의 서비스를 일부 사용자에게 배포하여 정상 유무를 확인
  - blue-green deployment
    - 하나는 운영 환경으로, 하나는 릴리스 환경으로 버전 배포 때마다 역할을 바꿈
    - 한쪽에 새로운 버전을 배포하여 사용자의 요청을 새 버전으로 라우팅하고, 문제가 없으면 이전 환경의 사용을 중지, 다음 버전 배포 때는 중지된 환경으로 새로운 버전을 배포하고 역할을 바꿈
  - 두 전략을 활용하여 안정적으로 서비스를 운영하는 것이 필요



## 2. Cloud Providers



### 2.1. AWS



### 2.2. Azure



## 3. Cloud Design Patterns



### 3.1. Availability



### 3.2. Data Management



### 3.3. Design and Implementation



### 3.4. Management and Monitoring